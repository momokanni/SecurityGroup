<svg id="SvgjsSvg1006" width="1351" height="642" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1024" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1025" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1032" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1033" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1047" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1048" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1055" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1056" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1070" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1071" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1082" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1083" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1093" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1094" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1101" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1102" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1109" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1110" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1113" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1114" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1121" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1122" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker><marker id="SvgjsMarker1129" markerWidth="16" markerHeight="12" refX="16" refY="6" viewBox="0 0 16 12" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1130" d="M0,2 L14,6 L0,11 L0,2" fill="#323232" stroke="#323232" stroke-width="2"></path></marker></defs><g id="SvgjsG1008" transform="translate(25,25)"><path id="SvgjsPath1009" d="M 116 30L 116 592" stroke-dasharray="3,4" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1010" d="M 0 0L 232 0L 232 30L 0 30Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1011"><foreignObject id="SvgjsForeignObject1012" width="212" height="16" x="10" style="overflow:visible;" y="7"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 700; line-height: 16px; width: 212px; word-break: break-word; border: 0px;">RememberMeAuthenticationFilter</div></foreignObject></g></g><g id="SvgjsG1013" transform="translate(294,25)"><path id="SvgjsPath1014" d="M 110 30L 110 592" stroke-dasharray="3,4" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1015" d="M 0 0L 220 0L 220 30L 0 30Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1016"><foreignObject id="SvgjsForeignObject1017" width="200" height="16" x="10" style="overflow:visible;" y="7"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 700; line-height: 16px; width: 200px; word-break: break-word; border: 0px;">AbstractRememberMeServices</div></foreignObject></g></g><g id="SvgjsG1018" transform="translate(126,89)"><path id="SvgjsPath1019" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 497Q 30 501 26 501L 4 501Q 0 501 0 497L 0 4Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1020" transform="translate(389,98)"><path id="SvgjsPath1021" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 343Q 30 347 26 347L 4 347Q 0 347 0 343L 0 4Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1022"><path id="SvgjsPath1023" d="M156 112L272.5 112L272.5 112L389 112" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1024)"></path></g><g id="SvgjsG1026" transform="translate(193,77)"><path id="SvgjsPath1027" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1028"><foreignObject id="SvgjsForeignObject1029" width="160" height="16" x="0" style="overflow:visible;" y="12"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 160px; word-break: break-word; border: 0px;">autoLogin(..)</div></foreignObject></g></g><g id="SvgjsG1030"><path id="SvgjsPath1031" d="M419 120L449 120L449 143L419 143" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1032)"></path></g><g id="SvgjsG1034" transform="translate(419,77)"><path id="SvgjsPath1035" d="M 0 0L 203 0L 203 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1036"><foreignObject id="SvgjsForeignObject1037" width="203" height="32" x="0" style="overflow:visible;" y="4"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 203px; word-break: break-word; border: 0px;">从request中提取cookie：<font color="#cc6600">extractRememberMeCookie(..)</font></div></foreignObject></g></g><g id="SvgjsG1038" transform="translate(618,25)"><path id="SvgjsPath1039" d="M 149.5 30L 149.5 577" stroke-dasharray="3,4" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1040" d="M 0 0L 299 0L 299 30L 0 30Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1041"><foreignObject id="SvgjsForeignObject1042" width="279" height="16" x="10" style="overflow:visible;" y="7"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 700; line-height: 16px; width: 279px; word-break: break-word; border: 0px;">PersistentTokenBasedRememberMeServices</div></foreignObject></g></g><g id="SvgjsG1043" transform="translate(752.5,143)"><path id="SvgjsPath1044" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 233Q 30 237 26 237L 4 237Q 0 237 0 233L 0 4Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1045"><path id="SvgjsPath1046" d="M419 157L586 157L586 157L753 157" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1047)"></path></g><g id="SvgjsG1049" transform="translate(425,158)"><path id="SvgjsPath1050" d="M 0 0L 324 0L 324 44L 0 44Z" stroke="none" fill="none"></path><g id="SvgjsG1051"><foreignObject id="SvgjsForeignObject1052" width="324" height="32" x="0" style="overflow:visible;" y="6"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 324px; word-break: break-word; border: 0px;"><font color="#cc6600">processAutoLoginCookie(..) </font>: 查询token是否存在以及验证有效性，若有效则生成新的token进行替换</div></foreignObject></g></g><g id="SvgjsG1053"><path id="SvgjsPath1054" d="M782 165L812 165L812 189L782 189" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1055)"></path></g><g id="SvgjsG1057" transform="translate(807,143)"><path id="SvgjsPath1058" d="M 0 0L 66 0L 66 20L 0 20Z" stroke="none" fill="none"></path><g id="SvgjsG1059"><foreignObject id="SvgjsForeignObject1060" width="66" height="16" x="0" style="overflow:visible;" y="2"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 66px; word-break: break-word; border: 0px;">newToken</div></foreignObject></g></g><g id="SvgjsG1061" transform="translate(953,25)"><path id="SvgjsPath1062" d="M 92 30L 92 577" stroke-dasharray="3,4" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1063" d="M 0 0L 184 0L 184 30L 0 30Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1064"><foreignObject id="SvgjsForeignObject1065" width="164" height="16" x="10" style="overflow:visible;" y="7"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 700; line-height: 16px; width: 164px; word-break: break-word; border: 0px;">JdbcTokenRepositoryImpl</div></foreignObject></g></g><g id="SvgjsG1066" transform="translate(1030,186)"><path id="SvgjsPath1067" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 62Q 30 66 26 66L 4 66Q 0 66 0 62L 0 4Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1068"><path id="SvgjsPath1069" d="M782 221L906 221L906 221L1030 221" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1070)"></path></g><g id="SvgjsG1072" transform="translate(858,181)"><path id="SvgjsPath1073" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1074"><foreignObject id="SvgjsForeignObject1075" width="160" height="32" x="0" style="overflow:visible;" y="4"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 160px; word-break: break-word; border: 0px;">将更新后的token插入到数据库<font color="#cc6600">updateToken(..)</font></div></foreignObject></g></g><g id="SvgjsG1076" transform="translate(824,239)"><path id="SvgjsPath1077" d="M 0 0L 86 0L 86 22L 0 22Z" stroke="none" fill="none"></path><g id="SvgjsG1078"><foreignObject id="SvgjsForeignObject1079" width="86" height="16" x="0" style="overflow:visible;" y="3"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 86px; word-break: break-word; border: 0px;">addCookie(..)</div></foreignObject></g></g><g id="SvgjsG1080"><path id="SvgjsPath1081" d="M782 235L812 235L812 264L782 264" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1082)"></path></g><g id="SvgjsG1084" transform="translate(1164,25)"><path id="SvgjsPath1085" d="M 81 30L 81 577" stroke-dasharray="3,4" stroke="#323232" stroke-width="2" fill="none"></path><path id="SvgjsPath1086" d="M 0 0L 162 0L 162 30L 0 30Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1087"><foreignObject id="SvgjsForeignObject1088" width="142" height="16" x="10" style="overflow:visible;" y="7"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 700; line-height: 16px; width: 142px; word-break: break-word; border: 0px;">(I) UserDetailsService</div></foreignObject></g></g><g id="SvgjsG1089" transform="translate(1230,261)"><path id="SvgjsPath1090" d="M 0 4Q 0 0 4 0L 26 0Q 30 0 30 4L 30 96Q 30 100 26 100L 4 100Q 0 100 0 96L 0 4Z" stroke="#323232" stroke-width="2" fill-opacity="1" fill="#ffffff"></path></g><g id="SvgjsG1091"><path id="SvgjsPath1092" d="M782 278L1006 278L1006 278L1230 278" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1093)"></path></g><g id="SvgjsG1095" transform="translate(1070,230)"><path id="SvgjsPath1096" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1097"><foreignObject id="SvgjsForeignObject1098" width="160" height="48" x="0" style="overflow:visible;" y="-4"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 160px; word-break: break-word; border: 0px;">根据token里的<font color="#cc0000">userName</font>获取<font color="#cc0000">UserDetails</font><div><font color="#cc6600">loadUserByUsername(..)</font><font color="#cc0000"><div></div></font></div></div></foreignObject></g></g><g id="SvgjsG1099"><path id="SvgjsPath1100" d="M1230 330L1006 330L1006 330L782 330" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1101)"></path></g><g id="SvgjsG1103" transform="translate(698,304.75)"><path id="SvgjsPath1104" d="M 0 0L 160 0L 160 24.5L 0 24.5Z" stroke="none" fill="none"></path><g id="SvgjsG1105"><foreignObject id="SvgjsForeignObject1106" width="160" height="16" x="0" style="overflow:visible;" y="4.25"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 160px; word-break: break-word; border: 0px;">返回UserDetails</div></foreignObject></g></g><g id="SvgjsG1107"><path id="SvgjsPath1108" d="M753 330L586 330L586 330L419 330" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1109)"></path></g><g id="SvgjsG1111"><path id="SvgjsPath1112" d="M419 345L449 345L449 369L419 369" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1113)"></path></g><g id="SvgjsG1115" transform="translate(452,339.25)"><path id="SvgjsPath1116" d="M 0 0L 220 0L 220 54.75L 0 54.75Z" stroke="none" fill="none"></path><g id="SvgjsG1117"><foreignObject id="SvgjsForeignObject1118" width="220" height="64" x="0" style="overflow:visible;" y="-4.625"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 220px; word-break: break-word; border: 0px;"><font color="#cc6600">createSuccessfulAuthentication(..)</font> : 将获取的<font color="#cc0000">UserDetails</font>放入新创建的<font color="#cc0000">RememberMeAuthenticationToken</font>实例中，并返回</div></foreignObject></g></g><g id="SvgjsG1119"><path id="SvgjsPath1120" d="M389 371L272.5 371L272.5 371L156 371" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1121)"></path></g><g id="SvgjsG1123" transform="translate(196,347)"><path id="SvgjsPath1124" d="M 0 0L 160 0L 160 20L 0 20Z" stroke="none" fill="none"></path><g id="SvgjsG1125"><foreignObject id="SvgjsForeignObject1126" width="160" height="16" x="0" style="overflow:visible;" y="2"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 160px; word-break: break-word; border: 0px;">返回Authentication</div></foreignObject></g></g><g id="SvgjsG1127"><path id="SvgjsPath1128" d="M156 389L186 389L186 415L156 415" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1129)"></path></g><g id="SvgjsG1131" transform="translate(188,394)"><path id="SvgjsPath1132" d="M 0 0L 188 0L 188 37L 0 37Z" stroke="none" fill="none"></path><g id="SvgjsG1133"><foreignObject id="SvgjsForeignObject1134" width="188" height="64" x="0" style="overflow:visible;" y="-13.5"><div xmlns="http://www.w3.org/1999/xhtml" style="font-family: 微软雅黑; text-align: center; font-size: 13px; vertical-align: middle; color: rgb(50, 50, 50); font-weight: 400; line-height: 16px; width: 188px; word-break: break-word; border: 0px;">将用户信息放到session中<font color="#cc6600">SecurityContextHolder.getContext().setAuthentication(rememberMeAuth);</font></div></foreignObject></g></g></svg>